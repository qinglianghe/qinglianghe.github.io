<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Redis为不同的开发语言提供了客户端，如Java的Jedis、Python的redis-py等。">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis客户端">
<meta property="og:url" content="http://yoursite.com/2018/06/11/redis_03/index.html">
<meta property="og:site_name" content="heqingliang&#39;s Blog">
<meta property="og:description" content="Redis为不同的开发语言提供了客户端，如Java的Jedis、Python的redis-py等。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-06-27T04:24:06.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Redis客户端">
<meta name="twitter:description" content="Redis为不同的开发语言提供了客户端，如Java的Jedis、Python的redis-py等。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/06/11/redis_03/"/>





  <title>Redis客户端 | heqingliang's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">heqingliang's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/11/redis_03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="heqingliang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dva.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="heqingliang's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Redis客户端</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-11T00:00:00+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <hr>
<p><code>Redis</code>为不同的开发语言提供了客户端，如Java的Jedis、Python的redis-py等。</p>
<a id="more"></a>
<h3 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h3><p>Jedis是Java使用的较为广泛的客户端。</p>
<h4 id="获取Jedis"><a href="#获取Jedis" class="headerlink" title="获取Jedis"></a>获取Jedis</h4><p>Jedis属于Java的第三方开发包，可以在<a href="https://github.com/xetorthio/jedis" target="_blank" rel="noopener">https://github.com/xetorthio/jedis</a>获取。</p>
<h4 id="Jedis的使用"><a href="#Jedis的使用" class="headerlink" title="Jedis的使用"></a>Jedis的使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.pool2.impl.GenericObjectPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPool;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisTest</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        GenericObjectPoolConfig poolConfig = <span class="keyword">new</span> GenericObjectPoolConfig();</span><br><span class="line">        <span class="comment">// 设置开启jmx功能</span></span><br><span class="line">        poolConfig.setJmxEnabled(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 设置连接池没有连接后客户端的最大等待时间(单位为毫秒)</span></span><br><span class="line">        poolConfig.setMaxWaitMillis(<span class="number">3000</span>);</span><br><span class="line">        <span class="comment">// 初始化Jedis连接池</span></span><br><span class="line">        JedisPool jedisPool = <span class="keyword">new</span> JedisPool(poolConfig, <span class="string">"192.168.1.138"</span>, <span class="number">6379</span>);</span><br><span class="line">        </span><br><span class="line">        Jedis jedis = <span class="keyword">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 从连接池获取jedis对象</span></span><br><span class="line">            jedis = jedisPool.getResource();</span><br><span class="line">            </span><br><span class="line">            jedis.set(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br><span class="line">            System.out.println(jedis.get(<span class="string">"hello"</span>));</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (jedis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 如果使用JedisPool，close操作不是关闭连接，代表归还连接池</span></span><br><span class="line">                jedis.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Jedis连接池"><a href="#Jedis连接池" class="headerlink" title="Jedis连接池"></a>Jedis连接池</h5><p>Jedis提供了JedisPool这个类作为对Jedis的连接池，同时使用了Apache的<br>通用对象池工具common-pool作为资源的管理工具。</p>
<p>使用连接池的方式可以预先初始化好Jedis连接，所以每次只需要从Jedis连接池借用即可。</p>
<p>上面的代码创建了一个连接池，从连接池直接获取Jedis对象，然后执行<code>redis</code>的<code>set</code>、<code>get</code>操作。</p>
<p><code>GenericObjectPoolConfig</code>提供有很多参数，例如池子中最大连接数、最大空闲连接数、最小空闲连接数、连接活性检测，等等。下表是<code>Generic-ObjectPoolConfig</code>参数的含义：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th style="text-align:left">含义</th>
<th style="text-align:left">默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>maxActive</td>
<td style="text-align:left">连接池中最大的连接数</td>
<td style="text-align:left">8</td>
</tr>
<tr>
<td>maxIdle</td>
<td style="text-align:left">连接池中最大空闲的连接数</td>
<td style="text-align:left">8</td>
</tr>
<tr>
<td>maxWaitMillis</td>
<td style="text-align:left">当连接池资源用尽后，调用者的最大等待时间(单位为毫秒)，一般不建议使用默认值</td>
<td style="text-align:left">-1：表示永远超时，一直等</td>
</tr>
<tr>
<td>jmxEnable</td>
<td style="text-align:left">是否开启jmx监控，如果应用开启了jmx端口并且jmxEnable设置为true，就可以通过jconsole或者jvisualvm看到关于连接池的相关统计，有助于了解连接池的使用情况，并且可以针对其做监控统计</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td>minEvictableIdleTimeMillis</td>
<td style="text-align:left">连接的最小空闲空间，达到此值后空闲连接将被移除</td>
<td style="text-align:left">30分钟</td>
</tr>
<tr>
<td>numTestsPerEvictionRun</td>
<td style="text-align:left">做空闲连接检测时，每次的采样数</td>
<td style="text-align:left">3</td>
</tr>
<tr>
<td>testOnBorrow</td>
<td style="text-align:left">向连接池借用连接时是否做连接有效性检测(ping)，无法连接会被移除，每次借用都执行一次ping命令</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td>testOnReturn</td>
<td style="text-align:left">向连接池归还连接时是否做连接有效性检测(ping)，无法连接会被移除，每次借用都执行一次ping命令</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td>testWhileIdle</td>
<td style="text-align:left">向连接池借用连接时是否做连接空闲检测，空闲超时的连接会被移除</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td>timeBetweenEvictionRunsMillis</td>
<td style="text-align:left">空闲连接的检测周期</td>
<td style="text-align:left">-1：表示不做检测</td>
</tr>
<tr>
<td>blockWhenExhausted</td>
<td style="text-align:left">当连接池用尽后，调用者是否要等待，这个参数是和maxWaitMillis对应的，只有当此参数为true时，maxWaitMillis才会生效</td>
<td style="text-align:left">true</td>
</tr>
</tbody>
</table>
<h4 id="哈希操作"><a href="#哈希操作" class="headerlink" title="哈希操作"></a>哈希操作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jedis.hset(<span class="string">"myhash"</span>, <span class="string">"f1"</span>, <span class="string">"v1"</span>);</span><br><span class="line">jedis.hset(<span class="string">"myhash"</span>, <span class="string">"f2"</span>, <span class="string">"v2"</span>);</span><br><span class="line"><span class="comment">// 结果为：&#123;f1=v1, f2=v2&#125;</span></span><br><span class="line">jedis.hgetAll(<span class="string">"myhash"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="列表操作"><a href="#列表操作" class="headerlink" title="列表操作"></a>列表操作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jedis.rpush(<span class="string">"mylist"</span>, <span class="string">"1"</span>);</span><br><span class="line">jedis.rpush(<span class="string">"mylist"</span>, <span class="string">"2"</span>);</span><br><span class="line">jedis.rpush(<span class="string">"mylist"</span>, <span class="string">"3"</span>);</span><br><span class="line"><span class="comment">// 结果为：[1, 2, 3]</span></span><br><span class="line">jedis.lrange(<span class="string">"mylist"</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h4 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jedis.sadd(<span class="string">"myset"</span>, <span class="string">"a"</span>);</span><br><span class="line">jedis.sadd(<span class="string">"myset"</span>, <span class="string">"b"</span>);</span><br><span class="line">jedis.sadd(<span class="string">"myset"</span>, <span class="string">"b"</span>);</span><br><span class="line"><span class="comment">// 结果为：[b, a]</span></span><br><span class="line">jedis.smembers(<span class="string">"myset"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="有序集合操作"><a href="#有序集合操作" class="headerlink" title="有序集合操作"></a>有序集合操作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jedis.zadd(<span class="string">"myzset"</span>, <span class="number">99</span>, <span class="string">"tom"</span>);</span><br><span class="line">jedis.zadd(<span class="string">"myzset"</span>, <span class="number">66</span>, <span class="string">"peter"</span>);</span><br><span class="line">jedis.zadd(<span class="string">"myzset"</span>, <span class="number">33</span>, <span class="string">"james"</span>);</span><br><span class="line"><span class="comment">// 结果为：[[["james"],33.0], [["peter"],66.0], [["tom"],99.0]]</span></span><br><span class="line">jedis.zrangeWithScores(<span class="string">"myzset"</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h4 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h4><p><code>Redis</code>提供了<code>mget</code>、<code>mset</code>方法，但是并没有提供<code>mdel</code>方法，如果想实现这个功能，可以借助<code>Pipeline</code>来模拟批量删除，虽然不会像<code>mget</code>和<code>mset</code>那样是一个原子命令，但是在绝大数场景下可以使用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.pool2.impl.GenericObjectPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPool;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Pipeline;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisTest</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        GenericObjectPoolConfig poolConfig = <span class="keyword">new</span> GenericObjectPoolConfig();</span><br><span class="line">        <span class="comment">// 设置开启jmx功能</span></span><br><span class="line">        poolConfig.setJmxEnabled(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 设置连接池没有连接后客户端的最大等待时间(单位为毫秒)</span></span><br><span class="line">        poolConfig.setMaxWaitMillis(<span class="number">3000</span>);</span><br><span class="line">        <span class="comment">// 初始化Jedis连接池</span></span><br><span class="line">        JedisPool jedisPool = <span class="keyword">new</span> JedisPool(poolConfig, <span class="string">"192.168.1.138"</span>, <span class="number">6379</span>);</span><br><span class="line">        </span><br><span class="line">        Jedis jedis = <span class="keyword">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 从连接池获取jedis对象</span></span><br><span class="line">            jedis = jedisPool.getResource();</span><br><span class="line">            </span><br><span class="line">            String[] keys = &#123;<span class="string">"hello"</span>, <span class="string">"myhash"</span>, <span class="string">"mylist"</span>, <span class="string">"myset"</span>, <span class="string">"myzset"</span>&#125;;</span><br><span class="line">            <span class="comment">// 生成pipeline对象</span></span><br><span class="line">            Pipeline pipeline = jedis.pipelined();</span><br><span class="line">            <span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line">                pipeline.del(key);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 执行命令</span></span><br><span class="line">            pipeline.sync();</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (jedis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 如果使用JedisPool，close操作不是关闭连接，代表归还连接池</span></span><br><span class="line">                jedis.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的代码使用<code>jedis.pipelined()</code>生成一个<code>pipeline</code>对象，将<code>del</code>命令封装到<code>pipeline</code>中，此时命令并未执行，最后，使用<code>pipeline.sync()</code>执行命令。</p>
<p>可以使用<code>pipeline.syncAndReturnAll()</code>获得<code>pipeline</code>的执行命令后的返回值，例如下面代码将<code>set</code>和<code>incr</code>做了一次<code>pipeline</code>操作，并顺序打印两个命令的结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Pipeline pipeline = jedis.pipelined();</span><br><span class="line">			</span><br><span class="line">pipeline.set(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br><span class="line">pipeline.incr(<span class="string">"counter"</span>);</span><br><span class="line">List&lt;Object&gt; resultList = pipeline.syncAndReturnAll();</span><br><span class="line"><span class="keyword">for</span> (Object object : resultList) &#123;</span><br><span class="line">    System.out.println(object);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果为：</p>
<pre><code>OK
1
</code></pre><h3 id="redis-py"><a href="#redis-py" class="headerlink" title="redis-py"></a>redis-py</h3><p>redis-py是Python使用的较为广泛的客户端。</p>
<h4 id="获取redis-py"><a href="#获取redis-py" class="headerlink" title="获取redis-py"></a>获取redis-py</h4><pre><code>pip install redis
</code></pre><h3 id="redis-py的使用"><a href="#redis-py的使用" class="headerlink" title="redis-py的使用"></a>redis-py的使用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    test redis</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">'heqingliang'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_redis</span><span class="params">()</span>:</span></span><br><span class="line">    r = redis.StrictRedis(host=<span class="string">'192.168.1.138'</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line">    r.set(<span class="string">'hello'</span>, <span class="string">'world'</span>)</span><br><span class="line">    <span class="comment"># 结果为：b'world'</span></span><br><span class="line">    r.get(<span class="string">'hello'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    test_redis()</span><br></pre></td></tr></table></figure>
<h4 id="哈希操作-1"><a href="#哈希操作-1" class="headerlink" title="哈希操作"></a>哈希操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.hset(<span class="string">'myhash'</span>, <span class="string">'f1'</span>, <span class="string">'v1'</span>)</span><br><span class="line">r.hset(<span class="string">'myhash'</span>, <span class="string">'f2'</span>, <span class="string">'v2'</span>)</span><br><span class="line"><span class="comment"># 结果为：&#123;b'f1': b'v1', b'f2': b'v2'&#125;</span></span><br><span class="line">r.hgetall(<span class="string">'myhash'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="列表操作-1"><a href="#列表操作-1" class="headerlink" title="列表操作"></a>列表操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.rpush(<span class="string">'mylist'</span>, <span class="string">'1'</span>)</span><br><span class="line">r.rpush(<span class="string">'mylist'</span>, <span class="string">'2'</span>)</span><br><span class="line">r.rpush(<span class="string">'mylist'</span>, <span class="string">'3'</span>)</span><br><span class="line"><span class="comment"># 结果为：[b'1', b'2', b'3']</span></span><br><span class="line">r.lrange(<span class="string">'mylist'</span>, <span class="number">0</span>, <span class="number">-1</span>)</span><br></pre></td></tr></table></figure>
<h4 id="集合操作-1"><a href="#集合操作-1" class="headerlink" title="集合操作"></a>集合操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.sadd(<span class="string">'myset'</span>, <span class="string">'a'</span>)</span><br><span class="line">r.sadd(<span class="string">'myset'</span>, <span class="string">'b'</span>)</span><br><span class="line">r.sadd(<span class="string">'myset'</span>, <span class="string">'b'</span>)</span><br><span class="line"><span class="comment"># 结果为：&#123;b'a', b'b'&#125;</span></span><br><span class="line">r.smembers(<span class="string">'myset'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="有序集合操作-1"><a href="#有序集合操作-1" class="headerlink" title="有序集合操作"></a>有序集合操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.zadd(<span class="string">'myzset'</span>, <span class="string">'99'</span>, <span class="string">'tom'</span>)</span><br><span class="line">r.zadd(<span class="string">'myzset'</span>, <span class="string">'60'</span>, <span class="string">'peter'</span>)</span><br><span class="line">r.zadd(<span class="string">'myzset'</span>, <span class="string">'50'</span>, <span class="string">'james'</span>)</span><br><span class="line"><span class="comment"># 结果为：[(b'james', 50.0), (b'peter', 60.0), (b'tom', 99.0)]</span></span><br><span class="line">r.zrange(<span class="string">'myzset'</span>, <span class="number">0</span>, <span class="number">-1</span>, withscores=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Pipeline-1"><a href="#Pipeline-1" class="headerlink" title="Pipeline"></a>Pipeline</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mdel</span><span class="params">()</span>:</span></span><br><span class="line">    r = redis.StrictRedis(host=<span class="string">'192.168.1.138'</span>, port=<span class="number">6379</span>)</span><br><span class="line">    pipeline = r.pipeline(transaction=<span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> (<span class="string">'hello'</span>, <span class="string">'myhash'</span>, <span class="string">'mylist'</span>, <span class="string">'myset'</span>, <span class="string">'myzset'</span>):</span><br><span class="line">        pipeline.delete(key)</span><br><span class="line">    <span class="keyword">return</span> pipeline.execute()</span><br></pre></td></tr></table></figure>
<p>创建Pipeline时，参数<code>transaction=False</code>代表不使用事务。<code>pipeline.delete(key)</code>并没有执行命令，只是把命令封装到<code>Pipeline</code>中。调用<code>pipeline.execute()</code>真正执行命令，并返回相应的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pipeline.set(<span class="string">'hello'</span>, <span class="string">'world'</span>)</span><br><span class="line">pipeline.incr(<span class="string">'counter'</span>)</span><br><span class="line"></span><br><span class="line">print(pipeline.execute())</span><br></pre></td></tr></table></figure>
<p>输出结果为：</p>
<pre><code>[True, 2]
</code></pre><h3 id="客户端API"><a href="#客户端API" class="headerlink" title="客户端API"></a>客户端API</h3><h4 id="client-list"><a href="#client-list" class="headerlink" title="client list"></a>client list</h4><p>client list命令能列出与Redis服务端相连的所有客户端连接信息:</p>
<pre><code>127.0.0.1:6379&gt; client list
id=31 addr=192.168.1.1:52651 fd=6 name= age=2260 idle=2260 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=0 obl=0 oll=0 omem=0 events=r cmd=get
id=48 addr=127.0.0.1:51352 fd=7 name= age=816 idle=0 flags=N db=0 sub=0 psub=0 multi=-1 qbuf=0 qbuf-free=32768 obl=0 oll=0 omem=0 events=r cmd=client
</code></pre><p>属性的含义：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:left">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td style="text-align:left">客户端连接的唯一标识，这个id是随着Redis的连接自增的，重启Redis后会重置为0</td>
</tr>
<tr>
<td>addr</td>
<td style="text-align:left">客户端连接的ip和端口</td>
</tr>
<tr>
<td>fd</td>
<td style="text-align:left">socket的文件描述符</td>
</tr>
<tr>
<td>name</td>
<td style="text-align:left">客户端的连接名</td>
</tr>
<tr>
<td>age</td>
<td style="text-align:left">客户端连接存活时间</td>
</tr>
<tr>
<td>idle</td>
<td style="text-align:left">客户端连接空闲时间</td>
</tr>
<tr>
<td>flags</td>
<td style="text-align:left">客户端类型标识</td>
</tr>
<tr>
<td>db</td>
<td style="text-align:left">当前客户端正在使用的数据库索引下标</td>
</tr>
<tr>
<td>sub/pub</td>
<td style="text-align:left">当前客户端订阅的频道或者模式数</td>
</tr>
<tr>
<td>multi</td>
<td style="text-align:left">当前事务中已执行命令的个数</td>
</tr>
<tr>
<td>qbuf</td>
<td style="text-align:left">输入缓冲区总容量</td>
</tr>
<tr>
<td>qbuf-free</td>
<td style="text-align:left">输入缓冲区剩余容量</td>
</tr>
<tr>
<td>obl</td>
<td style="text-align:left">固定缓冲区的长度</td>
</tr>
<tr>
<td>oll</td>
<td style="text-align:left">动态缓冲区的列表的长度</td>
</tr>
<tr>
<td>omem</td>
<td style="text-align:left">固定缓冲区和动态缓冲区使用的容量</td>
</tr>
<tr>
<td>events</td>
<td style="text-align:left">文件描述符事件(r/w)：r和w分别代表客户端套接字可读和可写</td>
</tr>
<tr>
<td>cmd</td>
<td style="text-align:left">当前客户端最后一次执行的命令，不包括参数</td>
</tr>
</tbody>
</table>
<p><strong>输入缓冲区：qbuf、qbuf-free</strong></p>
<p>Redis为每个客户端分配了输入缓冲区，它的作用是将客户端发送的命令临时保存，同时Redis从会输入缓冲区读取命令并执行，输入缓冲区为客户端发送命令到Redis执行命令提供了缓冲功能。</p>
<p><code>client list</code>中<code>qbuf</code>和<code>qbuf-free</code>分别代表这个缓冲区的总容量和剩余容量，Redis没有提供相应的配置来规定每个缓冲区的大小，输入缓冲区会根据输入内容大小的不同动态调整，只是要求每个客户端缓冲区的大小不能超过1G，超过后客户端将被关闭。</p>
<p>输入缓冲使用不当会产生两个问题：</p>
<ul>
<li>一旦某个客户端的输入缓冲区超过1G，客户端将会被关闭。</li>
<li>输入缓冲区不受maxmemory控制，假设一个Redis实例设置了maxmemory为4G，已经存储了2G数据，但是如果此时输入缓冲区使用了3G，已经超过maxmemory限制，可能会产生数据丢失、键值淘汰、OOM等情况。</li>
</ul>
<p>造成输入缓冲区过大的原因：</p>
<ul>
<li>输入缓冲区的命令包含了大量bigkey</li>
<li>Redis发生了阻塞，短期内不能处理命令</li>
</ul>
<p>监控输入缓冲区异常的方法有两种：</p>
<ul>
<li>通过定期执行<code>client list</code>命令，收集<code>qbuf</code>和<code>qbuf-free</code>找到异常的连接记录并分析，最终找到可能出问题的客户端。</li>
<li>通过<code>info</code>命令的<code>info clients</code>模块，找到最大的输入缓冲区，<code>client_biggest_input_buf</code>代表最大的输入缓冲区。</li>
</ul>
<p><strong>输出缓冲区：obl、oll、omem</strong></p>
<p>与输入缓冲区不同的是，输出缓冲区的容量可以通过参数<code>client-outputbuffer-limit</code>来进行设置，并且输出缓冲区做得更加细致，按照客户端的不同<br>分为三种：普通客户端输出缓冲区、发布订阅客户端输出缓冲区、slave客户端输出缓冲区。</p>
<p>对应<code>redis.conf</code>的配置规则：</p>
<pre><code>client-output-buffer-limit &lt;class&gt; &lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;
</code></pre><p><code>&lt;class&gt;</code>：客户端类型，分为三种:</p>
<ul>
<li>normal：普通客户端</li>
<li>slave：slave客户端</li>
<li>pubsub：发布订阅客户端</li>
</ul>
<p><code>&lt;hard limit&gt;</code>：如果客户端使用的输出缓冲区大于<code>&lt;hard limit&gt;</code>，客户端会被立即关闭。</p>
<p><code>&lt;soft limit&gt;</code>和<code>&lt;soft seconds&gt;</code>：如果客户端使用的输出缓冲区超过了<code>&lt;soft limit&gt;</code>并且持续了<code>&lt;soft limit&gt;</code>秒，客户端会被立即关闭。</p>
<p>Redis的默认配置是：</p>
<pre><code>client-output-buffer-limit normal 0 0 0
client-output-buffer-limit slave 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60
</code></pre><p>和输入缓冲区相同的是，输出缓冲区也不会受到maxmemory的限制，如果使用不当同样会造成maxmemory用满产生的数据丢失、键值淘汰、OOM等情况。</p>
<p>实际上输出缓冲区由两部分组成：固定缓冲区（16KB）和动态缓冲区，其中固定缓冲区返回比较小的执行结果，而动态缓冲区返回比较大的结果，例如大的字符串、<code>hgetall</code>、<code>smembers</code>命令的结果等。当固定缓冲区存满后会将Redis新的返回结果存放在动态缓冲区的队列中。</p>
<p><code>client list</code>中的<code>obl</code>代表固定缓冲区的长度，<code>oll</code>代表动态缓冲区列表的长度，<code>omem</code>代表使用的字节数。</p>
<p>监控输入缓冲区异常的方法有两种：</p>
<ul>
<li>通过定期执行<code>client list</code>命令，收集<code>obl</code>、<code>oll</code>、<code>omem</code>找到异常的连接记录并分析，最终找到可能出问题的客户端。</li>
<li>通过<code>info</code>命令的<code>info clients</code>模块，找到输出缓冲区列表最大对象数，<code>client_longest_output_list</code>代表输出缓冲区列表最大对象数。</li>
</ul>
<p>输出缓冲区预防:</p>
<ul>
<li>进行上述监控，设置阀值，超过阀值及时处理。</li>
<li><p>限制普通客户端输出缓冲区，可以进行如下设置：</p>
<pre><code>client-output-buffer-limit normal 20mb 10mb 120
</code></pre></li>
<li>适当增大slave的输出缓冲区的，如果master节点写入较大，slave客户端的输出缓冲区可能会比较大，一旦slave客户端连接因为输出缓冲区溢出被kill，会造成复制重连。</li>
<li>限制容易让输出缓冲区增大的命令，例如，高并发下的monitor命令就是一个危险的命令。</li>
<li>及时监控内存，一旦发现内存抖动频繁，可能就是输出缓冲区过大。</li>
</ul>
<p><strong>客户端的限制maxclients和timeout：</strong></p>
<p>Redis提供了<code>maxclients</code>参数来限制最大客户端连接数，一旦连接数超过<code>maxclients</code>，新的连接将被拒绝。<code>maxclients</code>默认值是10000，可以通过<code>info clients</code>来查询当前Redis的连接数：</p>
<pre><code>127.0.0.1:6379&gt; info clients
# Clients
connected_clients:1
client_longest_output_list:0
client_biggest_input_buf:0
blocked_clients:0
127.0.0.1:6379&gt; 
</code></pre><p>Redis提供了<code>timeout</code>（单位为秒）参数来限制连接的最大空闲时间，一旦客户端连接的<code>idle</code>时间超过了<code>timeout</code>，连接将会被关闭，Redis默认的<code>timeout</code>是0，也就是不会检测客户端的空闲，例如设置<code>timeout</code>为30秒：</p>
<pre><code>127.0.0.1:6379&gt; config set timeout 30
OK
</code></pre><p><strong>客户端类型：</strong></p>
<p><code>client list</code>中的<code>flag</code>是用于标识当前客户端的类型，例如<code>flag=S</code>代表当前客户端是slave客户端、<code>flag=N</code>代表当前是普通客户端。</p>
<table>
<thead>
<tr>
<th>客户端类型</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>N</td>
<td style="text-align:left">普通客户端</td>
</tr>
<tr>
<td>M</td>
<td style="text-align:left">当前客户端是master节点</td>
</tr>
<tr>
<td>S</td>
<td style="text-align:left">当前客户端是slave节点</td>
</tr>
<tr>
<td>O</td>
<td style="text-align:left">当前客户端正在执行monitor命令</td>
</tr>
<tr>
<td>x</td>
<td style="text-align:left">当前客户端正在执行事务</td>
</tr>
<tr>
<td>b</td>
<td style="text-align:left">当前客户端正在等待阻塞事件</td>
</tr>
<tr>
<td>d</td>
<td style="text-align:left">一个受监视的键已被修改，EXEC命令失败</td>
</tr>
<tr>
<td>u</td>
<td style="text-align:left">客户端未被阻塞</td>
</tr>
<tr>
<td>c</td>
<td style="text-align:left">回复完整输出后，关闭连接</td>
</tr>
<tr>
<td>A</td>
<td style="text-align:left">尽可能快地关闭连接</td>
</tr>
</tbody>
</table>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/07/redis_02/" rel="next" title="Redis慢查询、Pipeline、事务与Lua、Bitmaps、发布订阅">
                <i class="fa fa-chevron-left"></i> Redis慢查询、Pipeline、事务与Lua、Bitmaps、发布订阅
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/06/12/redis_04/" rel="prev" title="Redis持久化">
                Redis持久化 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/dva.jpg"
                alt="heqingliang" />
            
              <p class="site-author-name" itemprop="name">heqingliang</p>
              <p class="site-description motion-element" itemprop="description">曾梦想仗剑走天涯 看一看世界的繁华 年少的心总有些轻狂 如今你四海为家 曾让你心疼的姑娘 如今已悄然无踪影</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Jedis"><span class="nav-number">1.</span> <span class="nav-text">Jedis</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#获取Jedis"><span class="nav-number">1.1.</span> <span class="nav-text">获取Jedis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Jedis的使用"><span class="nav-number">1.2.</span> <span class="nav-text">Jedis的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Jedis连接池"><span class="nav-number">1.2.1.</span> <span class="nav-text">Jedis连接池</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#哈希操作"><span class="nav-number">1.3.</span> <span class="nav-text">哈希操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#列表操作"><span class="nav-number">1.4.</span> <span class="nav-text">列表操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集合操作"><span class="nav-number">1.5.</span> <span class="nav-text">集合操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#有序集合操作"><span class="nav-number">1.6.</span> <span class="nav-text">有序集合操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pipeline"><span class="nav-number">1.7.</span> <span class="nav-text">Pipeline</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#redis-py"><span class="nav-number">2.</span> <span class="nav-text">redis-py</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#获取redis-py"><span class="nav-number">2.1.</span> <span class="nav-text">获取redis-py</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#redis-py的使用"><span class="nav-number">3.</span> <span class="nav-text">redis-py的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#哈希操作-1"><span class="nav-number">3.1.</span> <span class="nav-text">哈希操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#列表操作-1"><span class="nav-number">3.2.</span> <span class="nav-text">列表操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#集合操作-1"><span class="nav-number">3.3.</span> <span class="nav-text">集合操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#有序集合操作-1"><span class="nav-number">3.4.</span> <span class="nav-text">有序集合操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pipeline-1"><span class="nav-number">3.5.</span> <span class="nav-text">Pipeline</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#客户端API"><span class="nav-number">4.</span> <span class="nav-text">客户端API</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#client-list"><span class="nav-number">4.1.</span> <span class="nav-text">client list</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">heqingliang</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
